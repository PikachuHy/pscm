cmake_minimum_required(VERSION 3.22)
project(pscm VERSION 0.1.0 LANGUAGES CXX)
set(CMAKE_CXX_STANDARD 20)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
set(CMAKE_EXPORT_COMPILE_COMMANDS ON)
add_subdirectory(3rd)
add_library(pscm)
target_include_directories(pscm PUBLIC include)
aux_source_directory(src PSCM_SRCS)
message(STATUS ${PSCM_SRCS})
target_sources(pscm PRIVATE ${PSCM_SRCS})
target_link_libraries(pscm PUBLIC spdlog::spdlog)
if (EMSCRIPTEN)
    target_link_options(pscm PUBLIC "-sEXPORTED_RUNTIME_METHODS=ccall,cwrap")
    target_link_options(pscm PUBLIC "-sNO_DISABLE_EXCEPTION_CATCHING")
    add_subdirectory(wasm)
endif ()
add_subdirectory(test)
add_subdirectory(example)
